axis:
  id: 12
  mode: CSP_PC
  group: HFM_REAL
  #parameters: powerAutoOnOff=2;powerOnDelay=6.0;powerOffDelay=1.0;
  feedSwitchesOutput: ec${MASTER_ID}.s${BO_SID}.binaryOutput${BO_CH} # e
  features:
    allowSrcChangeWhenEnabled: true

epics:
  name: TRYDW
  precision: 4
  unit: mm
  motorRecord:
    enable: true
    description: "HFM Y3 Downtream at Wall"
    fieldInit: "SPAM=0,RTRY=1,FOFF=Frozen,TWV=0.1"
    pvt:
      npoints: 10
      nreadback: 20

drive:
  numerator: 0.25               #
  denominator: 32768            # Always 16-bit MAX_INT for this stepper drive!
  type: 0                       # Type (0=Stepper, 1=Complex)
  control: ec$(MASTER_ID).s$(DRV_SID).driveControl01
  status: ec$(MASTER_ID).s$(DRV_SID).driveStatus01
  setpoint: ec$(MASTER_ID).s$(DRV_SID).velocitySetpoint01
  reduceTorqueEnable: yes
  reduceTorque: 2
  reset: 1
  warning: 7
  error:
    - 3              # Error 0 bit of status word

encoder:
  position: ec$(MASTER_ID).s$(ENC_SID).positionActual$(ENC_CHAN)
  type: 1               # Type (0=Incremental, 1=Absolute)
  numerator: 5          # 5 nm
  denominator: 1000000  #
  bits: 32              # Total bit count of encoder raw data
  absBits: 32           # Absolute bit count (for absolute encoders)
  absOffset: $(ENC_OFF) # Encoder offset in eng units (for absolute encoders)
  control: $(MASTER_ID).s$(ENC_SID).control
  status: $(MASTER_ID).s$(ENC_SID).status
  velocityFilterSize: 5
  latch:
    position: $(MASTER_ID).s$(ENC_SID).xxx
    armCmd: 5
    armBits: 3
  lookuptable:
    filename: test.abc
    enable: true

controller:
  Kp: 10.0
  Ki: 0.01
  Kd: 0.0

trajectory:
  axis:
    velocity: 0.1
    acceleration: 0.5          # accel. time 0.2 s
    deceleration: 0.8          # decel. time 0.2 s

input:
  limit:
    forward: ec$(MASTER_ID).s$(DRV_SID).driveStatus01.11
    backward: ec$(MASTER_ID).s$(DRV_SID).driveStatus01.12
  home: ec$(MASTER_ID).s$(DRV_SID).ONE.0
  interlock: ec$(MASTER_ID).s$(DRV_SID).ONE.0

# softlimits:
#   enable: yes
#   backwardEnable: yes
#   forwardEnable: yes
#   forward: 10.0
#   backward: -10.0

monitoring:
  lag:
    enable: yes
    tolerance: 0.125
    time: 1000
  target:
    enable: yes
    tolerance: 0.001
    time: 100
  velocity:
    enable: yes
    max: 0.25
    time:
      trajectory: 100
      drive: 200

plc:
  enable: true
  externalCommands: true
